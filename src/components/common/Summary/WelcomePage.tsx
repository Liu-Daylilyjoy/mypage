import React, { memo, useEffect, useRef } from "react";

const title = "Liudy's Home";
const quote = [
  `As the fields and gardens in home will be lying waste, why
  yet not go back! Since I have been familiar with that my heart
  has been put to be toiled by my body, why will be disconsolate
  and sad for myself alone?`,
  `They abused me for wearing orchids, and cursed me for plucking orchids,
  which I have longed for. I'll not regret even if I die several times.`,
  `Long long is the way, but nothing'll my effort arrest;
  Up hill and down dale for the beauty I will quest!`
];

const WelcomePage = () => {
  const textRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const textElement = textRef.current;
    if (!textElement) return;

    let currentText = '';
    let index = 0;
    let isDeleting = false;
    const typingSpeed = 50; // 打字速度的倒数
    let deletingSpeed = 3; // 删除速度（比打字速度快多少倍）
    let randomIndex = 0;

    // 等待指定时间
    const sleep = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));

    // 随机选择一段文字
    function getRandomText() {
      let newIndex = Math.floor(Math.random() * quote.length);

      while (newIndex === randomIndex) {
        newIndex = Math.floor(Math.random() * quote.length);
      }

      randomIndex = newIndex;
      return quote[randomIndex];
    }

    function typeWriter() {
      if (!isDeleting && index < currentText.length) {
        // 打字阶段
        textElement!.textContent = currentText.substring(0, index + 1);
        index++;
      } else if (!isDeleting && index === currentText.length) {
        // 打字完成，等待一段时间后开始删除
        sleep(2000).then(() => {
          isDeleting = true;
        });
      } else if (isDeleting && index > 0) {
        // 删除阶段
        textElement!.textContent = currentText.substring(0, index - 1);
        index -= deletingSpeed
        if (index < 0) {
          index = 0;
        }
      } else {
        textElement!.textContent = '';
        // 删除完成，重置状态并选择新的文字
        currentText = getRandomText();
        sleep(2000).then(() => {
          isDeleting = false;
        });
      }
    }

    currentText = getRandomText();
    const interval = setInterval(typeWriter, typingSpeed);

    return () => {
      clearInterval(interval);
    };
  }, []);

  return (
    <>
      <div className="max-w-3xl mb-10 text-6xl">
        <svg className="inline-block" width={90} viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4254">
          <path d="M768.41921375 801.95633187c-65.67685594-53.10043687-122.96943187-135.54585188-122.96943187-135.54585187l-9.78165938 8.38428c18.16593844 25.15283812 74.061135 96.41921437 118.77729281 132.75109125 46.11353719 36.33187781 90.82969406 68.47161562 104.80349344 79.65065531 13.97379938 12.57641906 8.38427906 19.56331875 4.19213906 27.94759782-6.98689969 16.76855906 13.97379938 25.15283812 20.96069907 5.58952031 1.39738031-4.19214 2.79475969-9.78165938 2.79475968-16.76855906-2.79475969-26.55021844-53.10043687-48.90829687-118.77729281-102.00873375z" fill="#d81e06" p-id="4255"></path><path d="M637.06550187 656.62882063c54.49781625-12.57641906 86.637555 8.38427906 117.37991344 13.97379937-2.79475969-8.38427906-15.37117875-20.96069906-8.38428-23.75545875 27.94759781-9.78165938 58.68995625-4.19214 88.03493438-6.98689969-5.58951938-5.58951938-22.35807844-12.57641906-16.76855907-18.16593844 11.17903969-11.17903969 30.74235844-8.38427906 46.11353719-12.57641906-2.79475969-2.79475969-9.78165938-8.38427906-6.98689969-9.78165937 20.96069906-9.78165938 44.71615688-11.17903969 67.07423625-16.76855906-20.96069906-4.19214-41.92139719-4.19214-61.48471593-12.57641907-2.79475969-1.39738031 2.79475969-6.98689969 4.19213906-9.78165937-32.13973781-4.19214-62.88209625 1.39738031-95.02183406-13.97379938 1.39738031-26.55021844 53.10043687-54.49781625 78.25327593-81.04803469-4.19214 0-13.97379938 2.79475969-12.57642-1.39738031 13.97379938-23.75545875 33.53711812-44.71615688 50.30567719-67.07423531-29.34497813 2.79475969-57.29257688 4.19214-86.637555 6.98689969 11.17903969-32.13973781 23.75545875-62.88209625 34.93449844-95.02183407-9.78165938 0-29.34497813 11.17903969-30.74235844 1.39737938-5.58951938-22.35807844 9.78165938-44.71615688 15.37117875-67.07423531-5.58951938 0-15.37117875 6.98689969-16.76855812 1.39737937-2.79475969-12.57641906 4.19214-26.55021844 6.98689875-39.1266375-4.19214 0-9.78165938 1.39738031-11.17903875-2.79475969-2.79475969-20.96069906 1.39738031-43.3187775 1.39737937-65.67685593-15.37117875 20.96069906-27.94759781 44.71615688-46.11353625 62.88209625-2.79475969 2.79475969-6.98689969-4.19214-9.78166031-6.98689969-8.38427906 13.97379938-11.17903969 33.53711812-25.15283813 43.3187775-5.58951938 4.19214-9.78165938-8.38427906-13.97379937-13.97379938-12.57641906 29.34497813-19.56331875 60.08733656-37.72925719 86.63755501-4.19214 5.58951938-11.17903969-11.17903969-12.57641906-13.97379938-2.79475969-2.79475969-4.19214 92.22707438-37.72925813 124.36681219-47.51091656-61.48471594-12.57641906-100.61135344-18.16593843-152.31441094-2.79475969 4.19214-8.38427906 15.37117875-9.78165938 9.78165938-6.98689969-19.56331875-4.19214-40.52401781-6.98689969-60.08733563-2.79475969 4.19214-8.38427906 16.76855906-9.78165937 12.57641906-5.58951938-13.97379938-2.79475969-30.74235844-4.19214-46.11353718-5.58951938 13.97379938-9.78165938 30.74235844-18.16593844 43.3187775-1.39738031 2.79475969-5.58951938-2.79475969-8.38428-5.58952032-1.39738031 15.37117875-15.37117875 46.11353719-32.13973781 46.11353719-12.57641906 0-30.74235844-46.11353719-46.11353719-68.47161562-1.39738031 1.39738031-4.19214 6.98689969-5.58951937 5.58952031-8.38427906-9.78165938-12.57641906-23.75545875-19.56331875-34.93449844-6.98689969 11.17903969-15.37117875 33.53711812-22.35807844 32.13973781-13.97379938-1.39738031-36.33187781-22.35807844-53.10043688-33.53711718 0 2.79475969 1.39738031 11.17903969-1.39738031 11.17903875-11.17903969-4.19214-19.56331875-13.97379938-29.34497812-20.96069813 0 2.79475969 2.79475969 11.17903969 0 9.78165938-18.16593844-8.38427906-33.53711812-22.35807844-48.90829688-33.53711813 4.19214 19.56331875 11.17903969 39.1266375 12.57641906 58.68995625 0 2.79475969-5.58951938-2.79475969-8.38427906-4.19214 2.79475969 11.17903969 8.38427906 23.75545875 8.38427906 34.93449844 0 4.19214-6.98689969-1.39738031-9.78165937-2.79476063 4.19214 20.96069906 13.97379938 48.90829687 11.17903969 62.88209625-1.39738031 6.98689969-25.15283812 5.58951938-39.1266375 8.38428 8.38427906 11.17903969 19.56331875 19.56331875 25.15283812 32.13973782 1.39738031 2.79475969-4.19214 2.79475969-6.98689969 4.19214 15.37117875 22.35807844 51.70305656 55.89519656 47.5109175 68.47161562-5.58951938 15.37117875-40.52401781 16.76855906-54.49781718 12.57641906 0 2.79475969 4.19214 8.38427906 1.39738031 9.78165938-15.37117875 4.19214-30.74235844 1.39738031-46.11353719 1.39737937 13.97379938 6.98689969 30.74235844 11.17903969 40.52401781 20.96069907 4.19214 4.19214-9.78165938 2.79475969-15.37117968 4.19214 18.16593844 9.78165938 37.72925719 15.37117875 53.10043687 29.34497812 4.19214 2.79475969-8.38427906 4.19214-12.57641906 5.58951938 44.71615688 25.15283812 93.62445375 6.98689969 134.14847156 74.061135-41.92139719 18.16593844-129.95633156-13.97379938-129.95633156-11.17903875 1.39738031 2.79475969 13.97379938 15.37117875 8.38427906 16.76855906-30.74235844 6.98689969-62.88209625 1.39738031-93.62445375 2.79475969 2.79475969 5.58951938 12.57641906 13.97379938 6.98689969 18.16593843-13.97379938 8.38427906-33.53711812 4.19214-48.90829688 6.98689969 1.39738031 4.19214 5.58951938 9.78165938 2.79475969 11.17903969-23.75545875 9.78165938-50.30567719 12.57641906-76.85589562 19.56331875 20.96069906 8.38427906 41.92139719 12.57641906 61.48471593 23.75545875 2.79475969 1.39738031-1.39738031 6.98689969-2.79475968 11.17903875 12.57641906 2.79475969 27.94759781 0 39.1266375 8.38428 4.19214 2.79475969-5.58951938 9.78165938-6.98689875 15.37117875 22.35807844 4.19214 48.90829687-2.79475969 68.47161562 11.17903969 8.38427906 5.58951938-8.38427906 19.56331875-12.57642 29.34497812 33.53711812 1.39738031 67.07423625 1.39738031 102.00873375 2.79475969-12.57641906 26.55021844-25.15283812 51.70305656-39.1266375 78.253275 26.55021844-6.98689969 53.10043687-18.16593844 81.04803563-22.35807844 4.19214 0-2.79475969 8.38427906-2.79476063 11.17903875 34.9344975-13.97379938 79.65065531-51.70305656 104.80349344-41.92139719 2.79475969 36.33187781-15.37117875 61.48471594-23.75545781 93.62445375 4.19214 0 11.17903969-4.19214 11.17903875-1.39737937 0 20.96069906-8.38427906 40.52401781-12.57641907 61.48471594 13.97379938-18.16593844 23.75545875-39.1266375 40.52401782-55.89519657 2.79475969-2.79475969 4.19214 6.98689969 6.98689968 9.78165938 9.78165938-12.57641906 13.97379938-32.13973781 27.94759782-37.72925719 6.98689969-2.79475969 6.98689969 15.37117875 9.78165937 22.35807844 12.57641906-26.55021844 19.56331875-57.29257688 39.1266375-78.253275 5.58951938-5.58951938 12.57641906 11.17903969 18.16593938 16.76855906 6.98689969-30.74235844-1.39738031-68.47161562 32.13973781-114.58515281-1.39738031-1.39738031-2.79475969-4.19214-4.19214-5.58952031l-120.17467219 138.34061156 110.39301281-143.93013094-321.39738-16.76855906 315.80786063 5.58951937-125.7641925-178.86462843-148.12227094-13.97379938h139.73799188l-117.37991344-194.23580719 127.16157281 185.85152813 53.10043594-114.58515281-41.92139719 128.55895218 127.16157188 177.46724813 132.75109218-345.15283781L632.87336281 638.46288219l199.8253275-53.10043688L632.87336281 649.64192094s1.39738031 2.79475969 4.19213907 6.98689968z" fill="#d81e06" p-id="4256"></path>
        </svg>
        {title}
      </div>
      <div className="max-w-3xl w-full text-xl/loose text-primary/70 text-wrap-balance ">
        <hr />
        <div className="mb-10 text-center" ref={textRef}>
        </div>
      </div>

      <div className="absolute bottom-15 left-1/2 -translate-x-1/2">
        <svg className="animate-bounce" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4182" width="50" height="50">
          <path fill="currentColor" d="M462 881V81c0-27.6 22.4-50 50-50s50 22.4 50 50v800c0 27.6-22.4 50-50 50s-50-22.4-50-50z" p-id="4183"></path>
          <path fill="currentColor" d="M483.3 907.6l212.1-212.1c19.5-19.5 51.2-19.5 70.7 0s19.5 51.2 0 70.7L554 978.4c-19.5 19.5-51.2 19.5-70.7 0-19.6-19.6-19.6-51.2 0-70.8z" p-id="4184"></path>
          <path fill="currentColor" d="M328.6 695.5l212.1 212.1c19.5 19.5 19.5 51.2 0 70.7s-51.2 19.5-70.7 0L257.9 766.2c-19.5-19.5-19.5-51.2 0-70.7s51.2-19.5 70.7 0z" p-id="4185"></path>
        </svg>
      </div>
    </>

  );
}

export default memo(WelcomePage);